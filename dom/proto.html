<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>documentåŸå‹ç»§æ‰¿</title>
  </head>
  <body>
    <div id="app"></div>
  </body>
  <script>
    // document å®ä¾‹åŒ–å¯¹è±¡é€šè¿‡ HTMLDocument æ„é€ å‡½æ•°ç”Ÿæˆ
    // HTMLDocument.prototype å®ä¾‹åŒ–å¯¹è±¡é€šè¿‡ Document æ„é€ å‡½æ•°ç”Ÿæˆ
    // document ç»§æ‰¿ => HTMLDocument.prototype ç»§æ‰¿ => Document.prototype
    console.log(document.__proto__ === HTMLDocument.prototype)
    console.log('HTMLDocument.prototype', HTMLDocument.prototype)
    console.log(HTMLDocument.prototype.__proto__ === Document.prototype)
    console.log('Document.prototype', Document.prototype)

    // ä¸ºä»€ä¹ˆdocumentä¸ç›´æ¥ç»§æ‰¿DocumentåŸå‹å¯¹è±¡ï¼Œä¸ºäº†åŒºåˆ†å¼€HTMLDocumentå’ŒXMLDocument

    /**
     * domç»“æ„æ ‘
     *                                        Node
     *         Document             CharacterData          Element          Attributes
     *            â¬‡ï¸                      â¬‡ï¸                 â¬‡ï¸
     * XMLDocument HTMLDocument     Text    Comment      HTMLElement
     *                                                       â¬‡ï¸
     *                        (HTMLHeadElementã€HTMLBodyElementã€HTMLTitleElementã€HTMLParagraphElementã€
     *                         HTMLInputElementã€HTMLTableElementã€HTMLOtherElement)
     *
     *
     */

    /**
     * domæ“ä½œæ·±å…¥
     * document.getElementById æ–¹æ³•å­˜åœ¨äº Document.prototype èº«ä¸Šï¼ŒElement å’Œ HTMLElementæ²¡æœ‰æ­¤æ–¹æ³•
     * document.getElementsByName åŒä¸Š
     *
     * getElementsByTagName getElementsByClassName
     * querySelector querySelectorAll
     * è¿™å››ç§æ–¹æ³•å­˜åœ¨äº Document.prototype å’Œ Element.prototype
     */
    var divNode = document.getElementById('app')
    // é€šè¿‡ HTMLDivElement æ„é€ å‡½æ•°åˆ›å»ºå‡ºæ¥çš„å®ä¾‹åŒ–domå¯¹è±¡ï¼Œç»§æ‰¿ HTMLElement.prototype å’Œ Element.prototype å±æ€§å’Œæ–¹æ³•
    console.log(divNode.__proto__)
    // console.log(divNode.getElementById()) // not a function
    // console.log(divNode.getElementsByName()) // not a function

    // document.body document.title document.head ç»§æ‰¿ => HTMLDocument.prototype
    console.log(HTMLDocument.prototype)
    console.log(document.body)
    console.log(document.head)
    console.log(document.title)
    // document.documentElement ç»§æ‰¿ => Document.prototype
    console.log(document.documentElement) // è·å–htmlæ–‡æ¡£

    // ğŸŒ° åˆ¤æ–­çˆ¶å…ƒç´ æœ‰æ²¡æœ‰å­å…ƒç´ èŠ‚ç‚¹
    HTMLElement.prototype.hasChildren = function () {
      var nodes = this.childNodes,
        flags = false
      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].nodeType == 1) {
          flags = true
        }
      }
      return flags
    }

    // ğŸŒ° æ ¹æ®ä¸‹æ ‡æŸ¥æ‰¾å…ƒç´ ä¸‹å¯¹åº”çš„å­å…ƒç´ 
    HTMLElement.prototype.findIdxElement = function (idx) {
      var nodes = this.childNodes,
        elems = {
          length: 0,
          push: Array.prototype.push,
          splice: Array.prototype.splice,
        }

      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].nodeType == 1) {
          elems.push(nodes[i])
        }
      }
      return elems[idx]
    }

    // ğŸŒ° æ‰¾å‡ºä¸€ä¸ªå…ƒç´ çš„ç¬¬nå±‚çˆ¶å…ƒç´ 
    HTMLElement.prototype.findParentElement = function (n) {
      var elem = this,
        isNotNum = typeof n !== 'number'

      if (isNotNum) {
        return elem
      } else if (n < 0) {
        return undefined
      }

      while (n) {
        if (elem.nodeName === 'HTML') {
          elem = null
          return elem
        }
        elem = elem.parentNode
        n--
      }
      return elem
    }

    // ğŸŒ° æŸ¥æ‰¾å…„å¼Ÿå…ƒç´ èŠ‚ç‚¹ï¼Œå‚æ•°ä¸ºnæ”¯æŒæ­£è´ŸæŸ¥æ‰¾ï¼Œå‚æ•°0è¿”å›è‡ªèº«
    HTMLElement.prototype.findSiblingElement = function (n) {
      var elem = this
      while (n) {
        if (n > 0) {
          // å…¼å®¹ ie9 ä»¥ä¸‹
          if (elem.nextElementSibling) {
            elem = elem.nextElementSibling
          } else {
            for (
              elem = elem.nextSibling;
              elem && elem.nodeType !== 1;
              elem = elem.nextSibling
            );
          }
          n--
        } else if (n < 0) {
          if (elem.previousElementSibling) {
            elem = elem.previousElementSibling
          } else {
            for (
              elem = elem.previousSibling;
              elem && elem.nodeType !== 1;
              elem = elem.previousSibling
            );
          }
          n++
        }
      }
      return elem
    }

    // ğŸŒ° æ‰¾å‡ºä¸€ä¸ªçˆ¶å…ƒç´ ä¸‹é¢çš„æ‰€æœ‰å­å…ƒç´ 
    HTMLElement.prototype.findAllElement = function () {
      var temp = {
          length: 0,
          push: Array.prototype.push,
          splice: Array.prototype.splice,
        },
        len = node.childNodes.length,
        item
      for (var i = 0; i < len; i++) {
        item = node.childNodes[i]
        if (item.nodeType == 1) {
          temp[temp.length] = item
          temp.length++
        }
      }
      return temp
    }

    // ğŸŒ° å­å…ƒç´ å€’å™
    HTMLElement.prototype.flashback = function () {
      var children = this.childNodes,
        len = this.childNodes.length
      while (len--) {
        this.appendChild(children[len])
      }
    }

    // ğŸŒ° å°è£…ä¸€ä¸ª insertAfter æ–¹æ³•
    HTMLElement.prototype.insertAfter = function (target, origin) {
      var nextNode = origin.nextElementSibling
      nextNode ? this.insertBefore(target, nextNode) : this.appendChild(target)
    }
  </script>
</html>
