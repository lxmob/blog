<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>数组去重方法</title>
  </head>
  <body></body>

  <!-- 数组去重 -->
  <script>
    var uniqueArr = [1, 2, 2, "a", "b", "a", 4, 4, 7];
    Array.prototype.unique = function () {
      for (var i = 0; i < this.length; i++) {
        for (var j = i + 1; j < this.length; j++) {
          if (this[i] == this[j]) {
            this.splice(j, 1);
            j--;
          }
        }
      }
      return this;
    };
    console.log(uniqueArr.unique());

    Array.prototype.unique2 = function () {
      var temp = {},
        newArr = [];
      for (var i = 0; i < this.length; i++) {
        if (!temp.hasOwnProperty(this[i])) {
          temp[this[i]] = this[i];
          newArr.push(this[i]);
        }
      }
      return newArr;
    };
    console.log(uniqueArr.unique2());

    Array.prototype.unique3 = function () {
      return [...new Set(this)];
    };
    console.log(uniqueArr.unique3());

    Array.prototype.unique4 = function () {
      return this.filter((item, index) => this.indexOf(item) == index);
    };
    console.log(uniqueArr.unique4());

    Array.prototype.unique5 = function () {
      this.sort();
      for (var i = 0; i < this.length; i++) {
        if (this[i] == this[i + 1]) {
          this.splice(i, 1);
          i--;
        }
      }
      return this;
    };
    console.log(uniqueArr.unique5());

    Array.prototype.unique6 = function () {
      var arr = [];
      this.forEach((item) => {
        if (!arr.includes(item)) {
          arr.push(item);
        }
      });
      return arr;
    };
    console.log(uniqueArr.unique6());

    Array.prototype.unique7 = function () {
      return this.sort().reduce((pre, next) => {
        if (pre.length === 0 || pre[pre.length - 1] !== next) {
          pre.push(next);
        }
        return pre;
      }, []);
    };
    console.log(uniqueArr.unique7());
  </script>

  <!-- 数组扁平化并将扁平化后数组去重，然后进行升序排序 -->
  <script>
    var flatArr = [[1, 1, 2], 4, [7, 7, "a", ["a", "b", 10]], 10, 4, 6, [7, 9]];
    Array.prototype.flatten = function () {
      var fArr = [],
        len = this.length,
        item;

      for (var i = 0; i < len; i++) {
        item = this[i];
        if (isArray(item)) {
          fArr = fArr.concat(this.flatten.call(item));
        } else {
          fArr.push(item);
        }
      }
      return fArr;

      function isArray(target) {
        return {}.toString.call(target) === "[object Array]";
      }
    };
    console.log(flatArr.flatten());

    Array.prototype.flatten2 = function () {
      var fArr = [],
        toString = {}.toString;

      return this.reduce((pre, next) => {
        return pre.concat(
          toString.call(next) === "[object Array]" ? next.flatten2() : next
        );
      }, []);
    };
    console.log(flatArr.flatten2());

    Array.prototype.flatten3 = function () {
      return [...new Set(this.flat(Infinity))].sort((a, b) => a - b);
    };
    console.log(flatArr.flatten3());
  </script>
</html>
