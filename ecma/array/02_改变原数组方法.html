<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>改变原数组的方法</title>
  </head>
  <body></body>

  <!-- 
    push(...args)
    作用：末尾增加元素
    返回值：新数组的长度
  -->
  <script>
    var arr = [4, 5, 6];
    console.log(arr.push(1, 2, 3)); // 6
    console.log(arr); // [4, 5, 6, 1, 2, 3]

    // 源码实现
    Array.prototype.push = function () {
      for (var i = 0; i < arguments.length; i++) {
        this[this.length] = arguments[i];
      }
      return this.length;
    };
  </script>

  <!--  
    unshift(...args)
    作用：头部增加元素
    返回值：新数组的长度
  -->
  <script>
    var arr = [4, 5, 6];
    console.log(arr.unshift(1, 2, 3)); // 6
    console.log(arr); // [1, 2, 3, 4, 5, 6]

    // 源码实现
    // [1, 2, 3].unshift(4, 5)
    Array.prototype.unshift = function () {
      var argsLen = arguments.length,
          sumLen = argsLen + this.length;
      for(var i = sumLen - 1; i >= 0; i--){
        this[i] = this[i - argsLen];
        if(i - argsLen < 0){
          this[i] = arguments[i];
        }
      }
      return this.length;
    };
  </script>

  <!--  
    pop()
    作用：删除最后一个元素
    返回值：被删除的数（如果数组为空则返回 undefined）
  -->
  <script>
    var arr = [4, 5, 6];
    console.log(arr.pop()); // 6
    console.log(arr.pop()); // 5
    console.log(arr.pop()); // 4
    console.log(arr.pop()); // undefined

    // 源码实现
    Array.prototype.pop = function () {
      var len = this.length,
          cur = this[len - 1];
      if(!len) return cur;
      this.length--;
      return cur;
    };
  </script>

  <!--  
    shift()
    作用：删除第一个元素
    返回值：被删除的数（如果数组为空则返回 undefined）
  -->
  <script>
    var arr = [4, 5, 6];
    console.log(arr.shift()); // 4
    console.log(arr.shift()); // 5
    console.log(arr.shift()); // 6
    console.log(arr.shift()); // undefined

    // 源码实现
    // [1, 2, 3]
    // i = 0 [2, 3, undefined]
    Array.prototype.shift = function () {
      var len = this.length,
          cur = this[0];
      if(!len) return cur;
      for (var i = 0; i < len; i++) {
        this[i] = this[i + 1];
      }
      this.length--;
      return cur;
    };
  </script>

  <!--  
    splice(startIdx, delCount, ...args)
    作用：增删改数组
    返回值：被删除元素组成的数组，若没有被删除的元素则返回空数组
  -->
  <script>
    var arr = ['parrot', 'anemone', 'blue', 'trumpet', 'sturgeon'];
    console.log(arr.splice(arr.length - 3, 2)); // ['blue', 'trumpet']
    console.log(arr.splice(-2, 1)); // ['trumpet']
    console.log(arr.splice(2)); // ['blue', 'trumpet', 'sturgeon']

    // 获取指定的下标元素
    function splice(idx, arr) {
      return (idx += idx >= 0 ? 0 : arr.length);
    }
    console.log(arr[splice(3, arr)]); // 'trumpet'
    console.log(arr[splice(-3, arr)]); // 'blue'
  </script>

  <!--  
    reverse()
    作用：反转数组
    返回值：反转后的源数组
  -->
  <script>
    var arr = [1, 2, 3];
    console.log(arr.reverse()); // [3, 2, 1]
    console.log(arr); // [3, 2, 1]

    // 源码实现
    // [1, 2, 3]
    // i = 0 [3, 2, 1]
    // i = 1 [3, 2, 1]
    Array.prototype.reverse = function () {
      for (var i = 0; i < this.length >> 1; i++) {
        var temp = this[i];
        this[i] = this[this.length - 1 - i];
        this[this.length - 1 - i] = temp;
      }
      return this;
    };
  </script>

  <!--  
    sort(fn?)
    作用：数组排序
    如果省略参数元素按照转换为的字符串的各个字符的 Unicode 码进行排序
    返回值：排序后的源数组
  -->
  <script>
    var arr = [12, 32, 1, 2, 90, 56];
    arr.sort(); // [1, 12, 2, 32, 56, 90]
    function compareFn() {
      if(a > b){
        return 1 // 正值，[b, a]
      }else if(a < b){
        return -1 // 负值，[a, b]
      }else{
        return 0 // 不变
      }
    }
    arr.sort((a, b) => a - b); // [1, 2, 12, 32, 56, 90]
    arr.sort(() => Math.random() - 0.5); // 随机排列 => Math.random 开区间 0-1
  </script>
</html>
