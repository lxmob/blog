<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Array.prototype.unshift方法</title>
  </head>
  <body>
    <!--  
      Array.prototype.unshift(...args)
      向源数组开始头部增加元素，返回新数组的长度，改变原数组
    -->
  </body>

  <script>
    var arr = [4, 5, 6];
    console.log(arr.unshift(1, 2, 3)); // 6
    console.log(arr); // [1, 2, 3, 4, 5, 6]

    // 在非数组对象中使用
    var obj = {};
    Array.prototype.unshift.call(obj, 1, 2);
    console.log(obj); // { 0: 1, 1: 2, length: 2 }

    // 源码实现
    // [1, 2, 3]
    // unshift(4, 5)
    // i = 2 [1, 2, 3, x, 3]
    // i = 1 [1, 2, 3, 2, 3]
    // i = 0 [1, 2, 1, 2, 3]
    // j = 0 [4, 2, 1, 2, 3]
    // j = 1 [4, 5, 1, 2, 3]
    Array.prototype.unshift = function () {
      var idx = arguments.length;
      for (var i = this.length - 1; i >= 0; i--) {
        this[i + idx] = this[i];
      }
      for (var j = 0; j < arguments.length; j++) {
        this[j] = arguments[j];
      }
      return this.length;
    };
  </script>
</html>
