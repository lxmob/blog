数字货币发行
纸质货币是由国家批量印钞统一发行，每一张纸质货币都具备防伪标志
数字货币也可以由国家发行这就属于中心化机构统一管理，国家央行通过公私钥对数字货币进行签名
这样大家就可以验证手中的数字货币的真伪，假设现在发生一笔交易，由我向你转入一个数字货币
你可以通过这笔交易验证数字货币的真伪，验证后确实是由央行所发行的，交易完成
这里面数字货币并没有用到区块链技术，而是用到了密码学中的非对称加密算法

双花问题double spending attack
数字货币是一块文件是由央行发布的，文件的内容是不可以伪造的，但是可以复制
当发生交易时向商家购买100元的商品，将100元数字货币交付给商家
然后将100元数字货币复制多份，对复制后的100元数字货币进行多处支付
这就是与纸质货币的区别，纸质货币交易出去就没有了，这个就是双花攻击、双重支付

数字货币面临的主要挑战就是怎么防范双花攻击
具体解决方案，让央行在数据库中维护一张表，来记录发行数字货币的编号
通过这个编号在表中维护当前编号的数字货币在谁手中，每当发生交易时不仅要验证该币的真伪
还要向央行验证这个币是否在对方手中，如果确实存在那么交易通过
然后央行再把这个币的编号记录指向下一个人，这样就能够防止双花攻击，这种方式属于中心化的方案

如何使用去中心化的方式来构建一套数字货币方案呢？
比特币就是为了解决这个问题而诞生的，去中心化的方式要解决数字货币的两个问题
1.数字货币由谁发行、谁有权力发行数字货币、发行的时间、发行的数量？
2.如何验证交易的有效性、怎么防止双花攻击？

比如说有一个用户A他获得了发行货币的权力create coin(铸币权)
假设A发行了10个比特币，A将10个比特币交易给B和C，每个人给5个比特币
这笔交易需要A的签名(signed by A)证明是A同意的
同时这笔交易还要说明交易的10个比特币来源，来源指向铸币交易

比特币系统中每笔交易都包含了输入和输出两个部分
输入要说明币的来源，输出部分要给出收款人的公钥哈希
交易区块中还有一种指针指向前面某个交易的，为了说明币的来源

为什么要说明币的来源？
保证了该币的来源不是凭空捏造出来的，同时防范了双花攻击

用户A要给B转账首先需要知道B的公钥地址，还要知道A币的来源是否满足这次交易
同时B要知道A的公钥地址说明这笔交易是由A转账过来的，而且所有节点都需要知道A的公钥
为了验证区块交易内中A的签名，怎么才能知道A的公钥？
输入不仅要包含A币的来源还要包含A的公钥，A的公钥是在交易中自己给出来的
但是A的公钥又不能让A去说明，这样会产生安全漏洞，假设B'去伪造A的交易说自己公钥是A的
然后在交易中用自己的私钥签名，在其它节点收到交易后用假的公钥去验证私钥确实是对的，就会以为这笔交易是合法的
那么B'相当于把A账上的钱偷走了，怎么防范这个问题呢？

在A产生铸币交易coinbase tx时它的输出里面就有A的公钥哈希
转账交易中说明的A的公钥要与A币来源里面的公钥哈希对的上才行
比特币系统中将输入作为一段脚本程序、输出作为一段脚本程序bitcoin script
将当前交易块的输入脚本与上一区块的输出脚本合并为一个脚本运行如果没有任何错误那么就是通过

block header中包含了以下信息
1.version(比特币版本协议)
2.hash of previous block header(指向前一个区块指针)
3.merkle root hash(默克尔树根节点)
4.target(挖矿难度目标阈)
5.nonce(随机数)

block body中保存交易信息生成的merkle tree

系统中大多数节点都属于轻节点，全节点的数目不多
轻节点是没有参与区块链的构造和维护，它只是利用区块链的信息做一些查询之类的事务



