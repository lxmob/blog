首先非常感谢北大肖臻教授的区块链课程(http://zhenxiao.com/)
让我对区块链的认识有一个系统的知识体系结构，在今后的学习道路上不断前进


比特币是什么？
比特币是一种P2P的电子加密货币(crypto-currency)系统
它运用了密码学原理和区块链技术来实现去中心化的一种数字货币
它是由一位叫中本聪(satoshi)的伟大者发明
2008年发布的白皮书中提出的一种概念，描述如何解决数字货币双花问题
以及分布式系统共识机制达成去中心化目的，由中本聪与比特币核心开发团队共同开发
2009年1月3日正式发布


比特币虽然被称为加密货币但是它本身是不加密的
因为在区块链技术中交易记录、交易者账户地址以及交易金额公开透明
任何人都可以查看，简单点来讲就是一个公共账本任何人都可以参与记账


比特币用到了密码学中的两个功能哈希函数(hash-function)和签名(signed)
下面篇幅都是在介绍比特币中所运用的哈希函数，签名的内容是下一章节讲解


什么是哈希函数？
首先介绍什么是哈希，哈希指的是键值对组合，通过键名来映射键值
函数就是执行特定功能的代码块，哈希函数又称散列函数，将任意的键名数据
通过压缩随机形成摘要，使得数据量变的更小，遵循唯一性相当于你的指纹
ps这里描述成指纹不太恰当，简单理解，后续会解释为什么


比特币运用的哈希函数SHA-256(secure hash algorithm)
它具备三个重要的性质，防止哈希碰撞(collision resistance)、隐匿性(hiding)
以及解密友好(puzzle friendly)


什么是哈希碰撞？
即两个不同输入的值得到相同的输出结果(x!=y, H(x)==H(y))
哈希函数中哈希碰撞不可避免，因为输入的空间大于输出空间
例如有一个256位的哈希值，输出范围是2^256，而输入空间是不受限制的
哈希碰撞不可避免，但是想要人为的去创造哈希碰撞是没有一个高效方法的
假设给定一个x，通过x去找到y并且这两个哈希值还要相等，怎么解？
硬要实现的话可以通过蛮力求解(brute-force)的方式，一个个遍历x和y看哪个哈希值相等
如果输入的数是256位的，这种求解方法在实际中是不可行的，工作量会非常大


collision resistance性质
它可以用来对一个信息(message)求消息摘要(digest)
通过H(m)=digest，用来检测这个message的篡改
如果有人对message进行更改，那么它的哈希值肯定会发生变化
意思就是说找不到m'然后通过求出H(m')哈希值，使m'的哈希值与m相等
如果找到了那就是人为创造了哈希碰撞，所以没有什么好办法能够篡改内容


MD5的特殊性
MD5也属于哈希函数，早期大家认为它是遵循collision resistance性质的
但是后来大家找到了MD5中制造哈希碰撞的方法，相当于给破解了，现在已经不安全了
目前没有一个密码学专家能够在数学上证明哈希碰撞能够人为创造出来


hiding性质
哈希函数计算过程是单向的不可逆
给定一个x输出H(x)得到的哈希值，是无法通过H(x)哈希值反推出x的结果
但是输入值需要足够大，而且取值范围要分布均匀，各种取值的可能性是等概率的
如果不满足这两种特性也是比较容易被破解的


数字承诺(digital commitment)
比特币通过hiding和collision-resistance性质达成数字承诺
又可以称为密封信的数字等价物(digital equivalent of a sealed envelope)


现实生活中的密信(sealed envelope)
如果有一个人说，他可以预测股票走势，公开说一支股票明天会涨停
如果这个人具备影响力那么这支股票真的会受到他的影响要么涨停要么跌停，这就是公开预测结果的问题
那如果不公开，等到第二天再公开预测结果，大家应该怎么去判断他是否对预测结果进行过篡改呢
那么sealed envelope用处就出来了，他可以将预测的结果通过密封信件的形式交由第三方公证机构保管
等到第二天收盘时第三方公证机构去开启这个信封来判断预测到底是否准确


电子系统中的密信(digital sealed envelope)
把这个预测结果作为x算出它的哈希值，然后将哈希值公布出去
因为具备hiding的性质所以不知道x的结果是什么，到第二天收盘时再把这个预测结果公布出去
因为H(x)具有collision resistance的性质所以这个预测结果是不可能被篡改的


比特币中实际操作实现的细节
如果按照股票的例子，那么股票一共就几千支输入的空间不是足够大所以不满足hiding性质
那么常用的方法是将这个输入值拼接一个随机数(nonce)然后再一起取哈希值H(x+nonce)
这样就能够保证输入值是足够大的，并且分布也是均匀的


puzzle friendly性质
比特币中运用的哈希函数还有第三个性质，指哈希值的计算事先是不可预测的
通过一个输入值很难猜出它最后的哈希值是什么，只能通过对输入值一个个计算
看它的结果最后是否落在要求的范围内
