比特币中挖矿难度
比特币中采用的是SHA-256算法产生的哈希值是256位
所以整个输出空间是2^256个可能取值，调整目标空间占用输出空间的比例


为什么要调整挖矿难度？
保证每一个区块的出块时间固定在10分钟
在上一个调整后的周期内，平均出块时间超过10分钟，那么降低挖矿难度增大目标值
反之则提高挖矿难度减小目标值，每隔2016个区块都会调整一下挖矿难度，大约14天


如果出块时间太短会产生什么问题？
假设出块时间为1秒，比特币底层网络传播这个区块的时间大概是几十秒
如果有两个节点同时收到这个区块然后又同时发布了区块，这个时候就会产生分叉
分叉过多会危害到共识机制的安全性，比特币是假设算力掌握在大部分诚实节点手中
系统的总算力越强安全性就越好，所遭受51%攻击的算力就越大
如果系统中存在多个分叉那么算力会被分散
根据节点在网络中位置的不同收到消息的内容也不同，不同的节点可能会选择不同的分叉继续扩展
有恶意的节点就可以集中算力去攻击某个分叉，这样就可以让这个分叉变成最长合法链
因为这个时候诚实的节点算力被分散，那么恶意的节点采取攻击可能就不需要51%算力，也可能是10%


怎么调整挖矿难度？
比特币协议中规定每隔2016个区块重新调整一下目标阈值，大概每两个星期调整一下
调整时间公式target = target * (实际时间(actual time)/期望时间(expected time))
比特币中调整难度的范围是增大或减小4倍，不会超过这个范围


如果有恶意节点不调整挖矿难度呢？
在block header中有一个nbits阈值，这个nbits指的是target的压缩编码
每个节点收到发布区块都需要验证合法性，如果有节点投机取巧设置目标数过大不符合协议规定
这个区块是不会被诚实节点所接受的，算出的nonce值也不符合要求


比特币系统中在以下问题中都存在争议
为什么出块时间要设计为10分钟
为什么每隔2016个区块要调整难度
为什么区块大小设计为1MB
目前暂时没有哪篇论文去解释satoshi这样设计是合理的，只能说这样设计是最保守的
