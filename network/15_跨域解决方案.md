### cross domain

- 同源策略只针对浏览器（客户端）

### 方法一

- 服务器中转请求
- 定义：浏览器向同源的服务器发送数据请求，服务器通过转发给不同源的服务器来获取数据请求

### 方法二

- 设置基础域名（document.domain） + iframe
- 定义：需要将页面的 document.domain 设置为相同的基础域名，然后通过 iframe 引用一个与 API 相同源的页面下的 ajax 来实现数据请求
- [具体代码](https://github.com/lxmob/blog/blob/main/demos/cross/domain-iframe/index.html)

### 方法三

- window.name + iframe
- 每个浏览器窗口都有一个全局变量 window（包含 iframe 框架 contentWindow）
- 每个 window 对象都有一个 name 属性（一个窗口只有一个 name 属性）
- 该窗口在关闭前，所有页面都共享一个 name 属性并有读写权限（a 页面跳转到 b 页面）
- 无论窗口在被关闭前，载入什么页面，都不会改变 name 值
- 存储大小为 2mb 的字符串
- 如果父级窗口地址源和 iframe 地址源不同，父级无法通过 iframe.contentWindow.name 获取值
- 解决方案：先让 iframe 中的页面程序保存 window.name，然后跳转到与父级窗口同源的另一个页面，父级页面就可以从当前的 iframe 拿到该页面的 window.name
- [具体代码](https://github.com/lxmob/blog/blob/main/demos/cross/wname-iframe/index.html)

### 方法四（了解）

- window.postMessage + iframe
- 定义：iframe 子页面发送同源请求，然后通过 postMessage 向不同源的父页面传递数据，父页面通过 onmessage 事件监听子页面的数据传递
- 缺点：容易被攻击，兼容性差
- [具体代码](https://github.com/lxmob/blog/blob/main/demos/cross/postMessage-iframe/index.html)

### 方法五（了解）

- location.hash + iframe
- [具体代码](https://github.com/lxmob/blog/blob/main/demos/cross/hash-iframe/index.html)

### 方法六

- Cross-origin resource sharing
- 定义：跨域资源共享，通过设置响应头信息

```php
header('Access-Control-Allow-Origin: *')
header('Access-Control-Request-Methods: GET,POST')
```

### 方法七

- JSONP
- [具体代码](https://github.com/lxmob/blog/issues/66)
